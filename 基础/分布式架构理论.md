# 分布式架构理论

> Author: Sylvie233
>
> Date: 2023/5/8
>
> Point: P6



[TOC]

## 基础介绍

大型架构系统演变

<img src="分布式架构理论.assets/image-20230508183519847.png" alt="image-20230508183519847" style="zoom:67%;" />

单机系统

数据库与应用分离

使用缓存改善性能

应用服务集群化

数据库读写分离

使用反向代理和CDN加速响应

使用分布式文件系统和分布式数据库

使用消息队列和分布式服务

<img src="分布式架构理论.assets/image-20230509150352067.png" alt="image-20230509150352067" style="zoom:67%;" />









## 核心内容

### 分布式缓存

<img src="分布式架构理论.assets/image-20230509150702173.png" alt="image-20230509150702173" style="zoom:67%;" />

缓存命中率



**缓存读取：**

通读缓存

<img src="分布式架构理论.assets/image-20230509152043419.png" alt="image-20230509152043419" style="zoom:67%;" />



旁路缓存

<img src="分布式架构理论.assets/image-20230509152148984.png" alt="image-20230509152148984" style="zoom:67%;" />





**缓存类型：**

代理缓存

<img src="分布式架构理论.assets/image-20230509151451101.png" alt="image-20230509151451101" style="zoom:67%;" />



反向代理缓存

<img src="分布式架构理论.assets/image-20230509151548293.png" alt="image-20230509151548293" style="zoom:67%;" />

多层反向代理缓存

<img src="分布式架构理论.assets/image-20230509151710061.png" alt="image-20230509151710061" style="zoom:67%;" />



内容分发网络CDN

<img src="分布式架构理论.assets/image-20230509151819600.png" alt="image-20230509151819600" style="zoom:67%;" />

静态资源加速提供







**分布式对象缓存**

<img src="分布式架构理论.assets/image-20230509152602164.png" alt="image-20230509152602164" style="zoom:67%;" />

分布式对象缓存访问模型：

<img src="分布式架构理论.assets/image-20230509152815827.png" alt="image-20230509152815827" style="zoom:67%;" />

一致性hash算法：方便动态扩容时使用

![image-20230509152948075](分布式架构理论.assets/image-20230509152948075.png)

虚拟节点实现负载均衡









**缓存问题：**

1. 频繁修改德数据
2. 没有热点德访问
3. 数据不一致与脏读
4. 缓存雪崩





### 分布式消息队列

<img src="分布式架构理论.assets/image-20230509153410215.png" alt="image-20230509153410215" style="zoom:67%;" />



消息队列模型

1. 点对点模型
2. 发布订阅模型



点对点模型：使用一个消息队列

<img src="分布式架构理论.assets/image-20230509154344879.png" alt="image-20230509154344879" style="zoom:67%;" />



发布订阅模型：使用多个消息队列，利用路由算法路由到不同的消息队列



消息队列好处：

- 一步处理
- 易伸缩
- 使峰值变平缓
- 隔离失效机器及自我修复
- 解耦



消息队列问题：

- 消息无序
- 消息重入队列
- 竞态条件
- 复杂度风险



消息队列反模式：

- 阻塞式调用
- 耦合消息生产者和消费者
- 缺少坏消息处理











服务解耦

<img src="分布式架构理论.assets/image-20230509155347871.png" alt="image-20230509155347871" style="zoom:67%;" />





### 分布式数据存储















### 微服务

















